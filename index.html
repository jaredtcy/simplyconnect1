<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Nuvei Simply Connect Demo</title>
  <!-- Simply Connect JS library -->
  <script src="https://cdn.safecharge.com/safecharge_resources/v1/checkout/checkout.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #f0f2f5;
      min-height: 100vh;
      display: flex;
      align-items: flex-start;
      justify-content: center;
      padding: 40px 16px;
    }
    .page {
      width: 100%;
      max-width: 900px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
    }
    @media (max-width: 680px) {
      .page { grid-template-columns: 1fr; }
    }

    /* --- Left Panel: Order Config --- */
    .config-panel {
      background: #fff;
      border-radius: 12px;
      padding: 28px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    }
    .config-panel h2 {
      font-size: 18px;
      font-weight: 700;
      color: #1a1a2e;
      margin-bottom: 6px;
    }
    .config-panel .subtitle {
      font-size: 13px;
      color: #888;
      margin-bottom: 24px;
    }
    .badge {
      display: inline-block;
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffc107;
      border-radius: 6px;
      font-size: 11px;
      padding: 3px 8px;
      margin-bottom: 20px;
      font-weight: 600;
    }
    label {
      display: block;
      font-size: 12px;
      font-weight: 600;
      color: #555;
      margin-bottom: 4px;
      text-transform: uppercase;
      letter-spacing: 0.4px;
    }
    input, select {
      width: 100%;
      padding: 10px 12px;
      border: 1.5px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      color: #333;
      margin-bottom: 16px;
      transition: border-color 0.2s;
      background: #fafafa;
    }
    input:focus, select:focus {
      outline: none;
      border-color: #6c63ff;
      background: #fff;
    }
    .row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }

    .btn-pay {
      width: 100%;
      padding: 14px;
      background: linear-gradient(135deg, #6c63ff, #48c6ef);
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      transition: opacity 0.2s, transform 0.1s;
      margin-top: 4px;
    }
    .btn-pay:hover { opacity: 0.92; transform: translateY(-1px); }
    .btn-pay:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }

    .status-box {
      margin-top: 16px;
      padding: 12px 14px;
      border-radius: 8px;
      font-size: 13px;
      display: none;
    }
    .status-box.info    { background:#e8f4fd; color:#0c5460; border:1px solid #bee5eb; }
    .status-box.success { background:#d4edda; color:#155724; border:1px solid #c3e6cb; }
    .status-box.error   { background:#f8d7da; color:#721c24; border:1px solid #f5c6cb; }
    .status-box.show    { display: block; }

    /* --- Right Panel: Checkout Container --- */
    .checkout-panel {
      background: #fff;
      border-radius: 12px;
      padding: 28px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.08);
    }
    .checkout-panel h2 {
      font-size: 18px;
      font-weight: 700;
      color: #1a1a2e;
      margin-bottom: 6px;
    }
    .checkout-panel .subtitle {
      font-size: 13px;
      color: #888;
      margin-bottom: 20px;
    }
    #checkout {
      width: 100%;
      min-height: 480px;
      border: 2px dashed #e0e0e0;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #bbb;
      font-size: 14px;
      text-align: center;
      padding: 20px;
      transition: border-color 0.3s;
    }
    #checkout.active {
      border-color: #6c63ff;
      border-style: solid;
    }

    /* Result display */
    #result-area {
      margin-top: 16px;
      display: none;
    }
    #result-area.show { display: block; }
    #result-area pre {
      background: #1e1e2e;
      color: #cdd6f4;
      border-radius: 8px;
      padding: 14px;
      font-size: 11px;
      overflow-x: auto;
      white-space: pre-wrap;
      word-break: break-all;
    }
    .result-label {
      font-size: 12px;
      font-weight: 700;
      color: #555;
      margin-bottom: 6px;
      text-transform: uppercase;
    }

    hr { border: none; border-top: 1px solid #f0f0f0; margin: 16px 0; }
    .section-title {
      font-size: 11px;
      font-weight: 700;
      color: #aaa;
      text-transform: uppercase;
      letter-spacing: 0.6px;
      margin-bottom: 12px;
    }
  </style>
</head>
<body>
<div class="page">

  <!-- LEFT: Config Panel -->
  <div class="config-panel">
    <h2>Order Configuration</h2>
    <p class="subtitle">Fill in your credentials and order details, then click Pay.</p>
    <div class="badge">‚ö†Ô∏è Use sandbox credentials only ‚Äì never expose live secret keys</div>

    <div class="section-title">Merchant Credentials</div>
    <label>Merchant ID</label>
    <input id="merchantId" type="text" placeholder="e.g. 427583496191624621" />

    <label>Merchant Site ID</label>
    <input id="merchantSiteId" type="text" placeholder="e.g. 142033" />

    <label>Session Token</label>
    <input id="sessionToken" type="text" placeholder="Paste token from /openOrder response" />

    <hr />
    <div class="section-title">Order Details</div>

    <div class="row">
      <div>
        <label>Amount</label>
        <input id="amount" type="number" value="10.00" step="0.01" min="0.01" />
      </div>
      <div>
        <label>Currency</label>
        <select id="currency">
          <option value="USD">USD</option>
          <option value="EUR">EUR</option>
          <option value="GBP">GBP</option>
          <option value="CAD">CAD</option>
          <option value="AUD">AUD</option>
          <option value="SGD">SGD</option>
        </select>
      </div>
    </div>

    <label>Customer Name</label>
    <input id="fullName" type="text" value="John Doe" />

    <label>Customer Email</label>
    <input id="email" type="email" value="[email protected]" />

    <label>Country (Payment Optimization)</label>
    <select id="country">
      <option value="US">United States (US)</option>
      <option value="GB">United Kingdom (GB)</option>
      <option value="DE">Germany (DE)</option>
      <option value="SG">Singapore (SG)</option>
      <option value="AU">Australia (AU)</option>
      <option value="CA">Canada (CA)</option>
    </select>

    <hr />
    <div class="section-title">Billing Address</div>

    <label>Billing Country</label>
    <select id="billingCountry">
      <option value="US">United States (US)</option>
      <option value="GB">United Kingdom (GB)</option>
      <option value="DE">Germany (DE)</option>
      <option value="SG">Singapore (SG)</option>
      <option value="AU">Australia (AU)</option>
      <option value="CA">Canada (CA)</option>
      <option value="FR">France (FR)</option>
      <option value="NL">Netherlands (NL)</option>
      <option value="JP">Japan (JP)</option>
      <option value="IN">India (IN)</option>
      <option value="BR">Brazil (BR)</option>
      <option value="MX">Mexico (MX)</option>
      <option value="ZA">South Africa (ZA)</option>
    </select>

    <label>Address Line</label>
    <input id="billingAddress" type="text" placeholder="e.g. 123 Main Street" />

    <div class="row">
      <div>
        <label>City</label>
        <input id="billingCity" type="text" placeholder="e.g. New York" />
      </div>
      <div>
        <label>State / Region</label>
        <input id="billingState" type="text" placeholder="e.g. NY" />
      </div>
    </div>

    <label>ZIP / Postal Code</label>
    <input id="billingZip" type="text" placeholder="e.g. 10001" />

    <label>Environment</label>
    <select id="env">
      <option value="int">Integration / Sandbox (int)</option>
      <option value="prod">Production (prod)</option>
    </select>

    <button class="btn-pay" id="payBtn" onclick="launchCheckout()">
      üöÄ Launch Simply Connect
    </button>

    <div class="status-box" id="statusBox"></div>
  </div>

  <!-- RIGHT: Checkout Panel -->
  <div class="checkout-panel">
    <h2>Payment Form</h2>
    <p class="subtitle">The Simply Connect UI will render here after clicking Launch.</p>
    <div id="checkout">
      <div>
        <div style="font-size:40px;margin-bottom:12px;">üí≥</div>
        <div>Simply Connect will<br/>render here</div>
      </div>
    </div>
    <div id="result-area">
      <div class="result-label">Payment Result</div>
      <pre id="result-json"></pre>
    </div>
  </div>

</div>

<script>
  function showStatus(msg, type = 'info') {
    const box = document.getElementById('statusBox');
    box.textContent = msg;
    box.className = `status-box show ${type}`;
  }

  function launchCheckout() {
    const merchantId     = document.getElementById('merchantId').value.trim();
    const merchantSiteId = document.getElementById('merchantSiteId').value.trim();
    const sessionToken   = document.getElementById('sessionToken').value.trim();
    const amount         = parseFloat(document.getElementById('amount').value);
    const currency       = document.getElementById('currency').value;
    const fullName       = document.getElementById('fullName').value.trim();
    const email          = document.getElementById('email').value.trim();
    const country        = document.getElementById('country').value;
    const env            = document.getElementById('env').value;

    // Basic validation
    if (!merchantId || !merchantSiteId) {
      showStatus('‚ö†Ô∏è Please enter your Merchant ID and Merchant Site ID.', 'error');
      return;
    }
    if (!sessionToken) {
      showStatus('‚ö†Ô∏è Please paste your sessionToken from an /openOrder response.', 'error');
      return;
    }
    if (!amount || amount <= 0) {
      showStatus('‚ö†Ô∏è Please enter a valid amount.', 'error');
      return;
    }

    showStatus('‚è≥ Launching Simply Connect...', 'info');

    const checkoutEl = document.getElementById('checkout');
    checkoutEl.innerHTML = '';
    checkoutEl.classList.add('active');
    document.getElementById('result-area').classList.remove('show');

    try {
      checkout({
        sessionToken:   sessionToken,
        env:            env,
        merchantSiteId: merchantSiteId,
        merchantId:     merchantId,
        currency:       currency,
        amount:         amount,
        country:        country,
        locale:         'en_US',
        fullName:       fullName,
        email:          email,
        billingAddress: {
          email:   email,
          country: document.getElementById('billingCountry').value,
          address: document.getElementById('billingAddress').value.trim() || undefined,
          city:    document.getElementById('billingCity').value.trim() || undefined,
          state:   document.getElementById('billingState').value.trim() || undefined,
          zip:     document.getElementById('billingZip').value.trim() || undefined,
        },
        renderTo: '#checkout',
        onResult: function(result) {
          console.log('Simply Connect Result:', result);

          const status = result.result || result.transactionStatus || 'UNKNOWN';
          if (status === 'APPROVED') {
            showStatus('‚úÖ Payment Approved!', 'success');
          } else if (status === 'DECLINED') {
            showStatus('‚ùå Payment Declined: ' + (result.errorDescription || ''), 'error');
          } else if (result.cancelled) {
            showStatus('üö´ Payment Cancelled by user.', 'info');
          } else {
            showStatus('‚ö†Ô∏è Payment result: ' + status, 'info');
          }

          // Show raw result
          document.getElementById('result-json').textContent = JSON.stringify(result, null, 2);
          document.getElementById('result-area').classList.add('show');
        }
      });
      showStatus('‚úÖ Simply Connect launched! Complete payment in the form ‚Üí', 'success');
    } catch (err) {
      showStatus('‚ùå Error launching checkout: ' + err.message, 'error');
      checkoutEl.innerHTML = '<div style="color:#dc3545">Failed to load Simply Connect.<br/>Check console for details.</div>';
      console.error(err);
    }
  }
</script>
</body>
</html>
